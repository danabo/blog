<!--
  
  version of `ref` that outputs broken references as red links

  `ref` docs: https://gohugo.io/functions/ref/
  error handling: https://gohugo.io/functions/errorf
  making my own shortcodes: https://gohugo.io/templates/shortcode-templates/

-->
{{ $name := (.Get 0) }}
{{ $heading := (.Get 1) }}
{{ $postFile := (print "content/posts/" $name ".md") }}
{{ $fullTarget := (print $name "#" $heading) }}
{{ if (fileExists $postFile) }}
  {{ if eq $heading "" }}
    <a href="{{ ref . $name }}">{{ $name }}</a>
  {{ else }}
    <a href="{{ ref . $fullTarget }}">{{ $fullTarget }}</a>
  {{ end }}
{{ else }}
  {{ if eq $heading "" }}
    <a href="" class="broken">{{ $name }}</a>
  {{ else }}
    <a href="" class="broken">{{ $fullTarget }}</a>
  {{ end }}
{{ end }}

